{% extends "base.html" %}
{% block content %}
  <div class="card">
    <div class="row">
      <div>
        <div style="font-weight:700; font-size:16px;">Verticals / Sub-verticals</div>
        <div class="muted">Контекст бизнеса (“где живёт ICP и какие правила”)</div>
      </div>
    </div>

    <form method="post" action="/verticals/new" style="margin-top: 12px;">
      <div class="grid">
        <div>
          <label>Vertical name *</label>
          <input name="name" required placeholder="e.g. iGaming" />
        </div>
        <div>
          <label>Sub-vertical name (optional)</label>
          <input name="sub_name" placeholder="e.g. Affiliate Marketing" />
        </div>
        <div style="grid-column: 1 / -1;">
          <label>Description</label>
          <textarea name="description"></textarea>
        </div>
      </div>
      <div style="margin-top: 12px;">
        <button class="btn" type="submit">Create</button>
      </div>
    </form>

    <div style="margin-top: 16px;">
      {% if verticals|length == 0 %}
        <div class="muted">Пока пусто.</div>
      {% else %}
        <ul class="list">
          {% for v in verticals %}
            <li>
              <div class="row" style="justify-content: flex-start;">
                <div style="font-weight:700;">{{ v.name }}</div>
                <span class="muted" style="font-size: 13px;">(id={{ v.id }})</span>
              </div>
              {% if v.description %}
                <div class="muted" style="font-size: 13px; white-space: pre-wrap;">{{ v.description }}</div>
              {% endif %}
              {% if v.subs|length > 0 %}
                <div style="margin-top: 8px;" class="muted">Sub-verticals:</div>
                <ul class="list" style="margin-top: 6px;">
                  {% for s in v.subs %}
                    <li style="border-bottom: none; padding: 6px 0;">
                      <span class="pill">{{ s.name }}</span>
                      <span class="muted" style="font-size: 13px;">id={{ s.id }}</span>
                    </li>
                  {% endfor %}
                </ul>
              {% endif %}

              <form method="post" action="/verticals/{{ v.id }}/sub/new" style="margin-top: 10px;">
                <div class="grid">
                  <div>
                    <label>Add sub-vertical</label>
                    <input name="name" placeholder="Sub-vertical name" />
                  </div>
                  <div>
                    <label>Description</label>
                    <input name="description" placeholder="Short rules/economics" />
                  </div>
                </div>
                <div style="margin-top: 8px;">
                  <button class="btn secondary" type="submit">Add sub</button>
                </div>
              </form>
            </li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
  </div>
{% endblock %}

